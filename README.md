# Детектор людей в толпе

Проект на Python для обнаружения людей в видео и рисования ограничивающих рамок с указанием названия класса и достоверности.

## Функции

- Считывает видеофайл с помощью OpenCV.
- Выполняет  Ультралитический вывод YOLO для каждого кадра.
- Фильтрует обнаруженные объекты по классу человек .
- Рисует тонкие рамки + помечает "человек <conf>", чтобы избежать сильного перекрытия.
- Сохраняет видео с комментариями в формате MP4 (кодек "mp4v" для кроссплатформенной совместимости).
- Выводит основную статистику времени выполнения (обработанные кадры, эффективное количество кадров в секунду, среднее количество людей на кадр).

## Требования

- Python **3.8+** (тестируемая версия: 3.8.10)
- Операционная система: Linux / macOS / Windows

>  Примечание о Torch: "ultralytics" зависит от `torch`. В некоторых системах вам может потребоваться сначала установить соответствующее колесо "torch".
> Если на вашем компьютере не удается выполнить "pip install -r requirements.txt", установите PyTorch, следуя официальным инструкциям для вашей OS/CUDA,
> затем повторно запустите установку по требованиям.

```

Необязательные флаги:

- `-модель yolov8n.pt ` (по умолчанию) или `yolov8s.pt ` / `yolov8m.pt `для повышения качества
- `--conf 0,25` доверительный порог
- `--процессор устройства` или `--устройство 0` для графического процессора
- `--показать" для предварительного просмотра кадров (нажмите "q" для остановки)
- `-максимальное количество кадров 300` для тестирования на подмножестве

## Выходные данные

Результирующий файл представляет собой видео в формате MP4 с выделенными людьми в общих чертах и с пометками.

## Анализ качества и идеи по улучшению (на высоком уровне)

1. **Используйте более крупную модель** (`yolov8s.pt`/`yolov8m.pt`) или детектор, ориентированный на толпу.
2. **Настройте пороговые значения** ("--conf", "--iou") в зависимости от плотности толпы и точки обзора камеры.
3. **Отслеживание по кадрам** (ByteTrack/ DeepSORT) для стабилизации распознавания и уменьшения мерцания.
4. **Улучшение разрешения**: увеличение масштаба или наложение фрагментов / исправлений для небольших объектов, находящихся на большом расстоянии.
5. **Адаптация к предметной области**: точная настройка на небольшом подмножестве с маркировкой из "crowd.mp4".
6. **Постобработка**: геометрические параметры (минимальный/максимальный размер поля в зависимости от перспективы), варианты NMS, soft-NMS.

Смотрите "REPORT.md` для более структурированного обсуждения.
